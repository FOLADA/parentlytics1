# AI-ზე დაფუძნებული ყოველდღიური დიეტის რეკომენდაციის სისტემა

## 🎯 გადახედვა

ეს არის სრული AI-ზე დაფუძნებული ყოველდღიური დიეტის რეკომენდაციის სისტემა Parentlytics-სთვის, მშობლების პლატფორმა. სისტემა ავტომატურად ამზადებს პერსონალიზებულ ყოველდღიურ საკვების გეგმებს ბავშვებისთვის მათი ასაკის, წონის, აქტივობის დონის და ალერგიების მიხედვით.

## ✨ ფუნქციები

### ძირითადი ფუნქციონალურობა
- **პერსონალიზებული საკვების გეგმები**: AI-ზე დაფუძნებული ყოველდღიური საკვების გეგმები GPT-4-ის გამოყენებით
- **ბავშვის პროფილის მართვა**: შეინახეთ და მართეთ ბავშვის პროფილები დეტალური ჯანმრთელობის ინფორმაციით
- **ავტომატური ყოველდღიური გენერაცია**: ქრონ დავალება ყოველ ღამეს 12:00-ზე გაუშვებს ახალი საკვების გეგმების გენერაციას
- **რეალურ დროში გენერაცია**: საკვების გეგმის გენერაცია მოთხოვნის მიხედვით, თუ ყოველდღიური გეგმა არ არსებობს
- **საყიდლის სიის გენერაცია**: ავტომატური საყიდლის სიის შექმნა საკვების ინგრედიენტებიდან
- **ლამაზი UI**: რესპონსიული, ანიმირებული ინტერფეისი Framer Motion-ით

### ტექნიკური ფუნქციები
- **TypeScript**: სრული ტიპის უსაფრთხოება მთელი აპლიკაციის განმავლობაში
- **Supabase ინტეგრაცია**: მონაცემთა ბაზა ბავშვის პროფილებისა და საკვების გეგმების შესანახად
- **OpenAI GPT-4**: AI-ზე დაფუძნებული საკვების გეგმის გენერაცია
- **Vercel ქრონ დავალებები**: ავტომატიზებული ყოველდღიური საკვების გენერაცია
- **რესპონსიული დიზაინი**: მობილურზე ორიენტირებული დიზაინი Tailwind CSS-ით

## 🏗️ არქიტექტურა

### მონაცემთა ბაზის სქემა

#### ბავშვის პროფილების ცხრილი
```sql
CREATE TABLE child_profiles (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID NOT NULL,
  name TEXT NOT NULL,
  birthdate DATE NOT NULL,
  gender TEXT CHECK (gender IN ('male', 'female', 'other')) NOT NULL,
  weight DECIMAL(5,2) NOT NULL,
  height DECIMAL(5,2) NOT NULL,
  activity_level TEXT CHECK (activity_level IN ('low', 'moderate', 'high')) NOT NULL,
  allergies TEXT[] DEFAULT '{}',
  health_notes TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

#### ყოველდღიური საკვების ცხრილი
```sql
CREATE TABLE daily_meals (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID NOT NULL,
  child_id UUID NOT NULL REFERENCES child_profiles(id),
  date DATE NOT NULL,
  meal_plan JSONB NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  UNIQUE(user_id, date)
);
```

### ფაილების სტრუქტურა
```
├── app/
│   ├── diet/
│   │   └── page.tsx                 # ძირითადი დიეტის გვერდი
│   ├── api/
│   │   ├── diet/
│   │   │   └── today/
│   │   │       └── route.ts         # დღევანდელი საკვების მიღება
│   │   ├── generateMealPlanNow/
│   │   │   └── route.ts             # საკვების გეგმის გენერაცია მოთხოვნის მიხედვით
│   │   └── cron/
│   │       └── daily-meal-generator/
│   │           └── route.ts         # ყოველდღიური ქრონ დავალება
│   └── supabaseClient.ts            # Supabase კლიენტი
├── components/
│   ├── MealCard.tsx                 # ინდივიდუალური საკვების ჩვენება
│   ├── LoadingIndicator.tsx         # ჩატვირთვის ანიმაციები
│   └── ChildProfileSetup.tsx        # ბავშვის პროფილის ფორმა
├── lib/
│   ├── types.ts                     # TypeScript ინტერფეისები
│   ├── openai.ts                    # OpenAI ინტეგრაცია
│   └── supabase.ts                  # მონაცემთა ბაზის უტილიტები
└── vercel.json                      # ქრონ დავალების კონფიგურაცია
```

## 🚀 დაყენების ინსტრუქციები

### 1. გარემოს ცვლადები
შექმენით `.env.local` ფაილი შემდეგი ცვლადებით:

```bash
# Supabase კონფიგურაცია
NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key

# OpenAI კონფიგურაცია
OPENAI_API_KEY=your_openai_api_key

# ქრონ დავალების უსაფრთხოება
CRON_SECRET_TOKEN=your_secure_cron_token
```

### 2. მონაცემთა ბაზის დაყენება
გაუშვით შემდეგი SQL თქვენს Supabase SQL რედაქტორში:

```sql
-- ბავშვის პროფილების ცხრილის შექმნა
CREATE TABLE child_profiles (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID NOT NULL,
  name TEXT NOT NULL,
  birthdate DATE NOT NULL,
  gender TEXT CHECK (gender IN ('male', 'female', 'other')) NOT NULL,
  weight DECIMAL(5,2) NOT NULL,
  height DECIMAL(5,2) NOT NULL,
  activity_level TEXT CHECK (activity_level IN ('low', 'moderate', 'high')) NOT NULL,
  allergies TEXT[] DEFAULT '{}',
  health_notes TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- ყოველდღიური საკვების ცხრილის შექმნა
CREATE TABLE daily_meals (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID NOT NULL,
  child_id UUID NOT NULL REFERENCES child_profiles(id),
  date DATE NOT NULL,
  meal_plan JSONB NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  UNIQUE(user_id, date)
);

-- ინდექსების შექმნა უკეთესი წარმადობისთვის
CREATE INDEX idx_child_profiles_user_id ON child_profiles(user_id);
CREATE INDEX idx_daily_meals_user_date ON daily_meals(user_id, date);
```

### 3. დამოკიდებულებების დაყენება
```bash
npm install
```

### 4. განვითარების სერვერის გაშვება
```bash
npm run dev
```

## 🎨 UI კომპონენტები

### MealCard კომპონენტი
- აჩვენებს ინდივიდუალურ საკვებს ლამაზი გრადიენტებით
- აჩვენებს კალორიებს, ინგრედიენტებს და აღწერებს
- ანიმირებული Framer Motion-ით
- ფერადი კოდირებული საკვების ტიპის მიხედვით (საუზმე, სადილი, ვაშლი, სადილის შემდეგი სადილი)

### LoadingIndicator კომპონენტი
- ანიმირებული ჩატვირთვის მდგომარეობა მოლივლივე საკვების ხატულებით
- მორბენი გადასვლები და მიკრო-ინტერაქციები
- პროფესიონალური ჩატვირთვის გამოცდილება

### ChildProfileSetup კომპონენტი
- სრული ფორმა ბავშვის პროფილის შესაქმნელად
- ფორმის ვალიდაცია და შეცდომების დამუშავება
- ალერგიების მართვა ტეგებით
- რესპონსიული დიზაინი ყველა მოწყობილობისთვის

## 🔄 API ბოლოები

### GET `/api/diet/today`
მიიღებს დღევანდელი საკვების გეგმას შესული მომხმარებლისთვის.

**პასუხი:**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "user_id": "uuid",
    "child_id": "uuid",
    "date": "2025-01-30",
    "meal_plan": {
      "breakfast": { ... },
      "snack1": { ... },
      "lunch": { ... },
      "snack2": { ... },
      "dinner": { ... },
      "total_calories": 1350,
      "nutrition_notes": "..."
    },
    "created_at": "2025-01-30T00:00:00Z"
  }
}
```

### POST `/api/generateMealPlanNow`
ამზადებს ახალ საკვების გეგმას მოთხოვნის მიხედვით GPT-4-ის გამოყენებით.

**მოთხოვნა:**
```json
{
  "childProfile": {
    "name": "ნიკუშა",
    "birthdate": "2020-05-15",
    "weight": 15.5,
    "height": 95.2,
    "activity_level": "moderate",
    "allergies": ["ფუნდუქი"],
    "health_notes": "უყვარს ხილი"
  }
}
```

### POST `/api/cron/daily-meal-generator`
ქრონ დავალების ბოლო ყოველდღიური საკვების გენერაციისთვის (საჭიროებს ავტორიზაციას).

## 🤖 AI ინტეგრაცია

### GPT-4 პრომპტის სტრუქტურა
სისტემა იყენებს ყურადღებით შემუშავებულ პრომპტს, რომელიც შეიცავს:
- ბავშვის ასაკს (გამოთვლილი დაბადების თარიღიდან)
- წონას და სიმაღლეს პორციის ზომისთვის
- აქტივობის დონეს კალორიების საჭიროებისთვის
- ალერგიებს ინგრედიენტების თავიდან აცილებისთვის
- ჯანმრთელობის შენიშვნებს პერსონალიზაციისთვის

### საკვების გეგმის სტრუქტურა
თითოეული საკვების გეგმა შეიცავს:
- 5 საკვებს (საუზმე, 2 სადილის შემდგომი სადილი, სადილი, ვაშლი)
- დეტალურ აღწერებს და ინგრედიენტებს
- კალორიების დათვლას თითოეული საკვებისთვის და სულ
- ნუტრიციის შენიშვნებს მშობლებისთვის

## 🔒 უსაფრთხოების მოსაზრებები

### ავთენტიფიკაცია
- შეცვალეთ სადემონსტრაციო მომხმარებლის ID-ები ნამდვილი ავთენტიფიკაციით
- განახორციელეთ სწორი მომხმარებლის სესიის მართვა
- დაამატეთ როლების მიხედვით წვდომის კონტროლი

### API უსაფრთხოება
- შეამოწმეთ ყველა შეყვანილი მონაცემი
- განახორციელეთ სიჩქარის შეზღუდვა
- გამოიყენეთ გარემოს ცვლადები მნიშვნელოვანი მონაცემებისთვის
- დაიცავით ქრონ დავალება ავტორიზაციის ტოკენებით

## 📱 რესპონსიული დიზაინი

სისტემა აგებულია მობილურზე ორიენტირებული დიზაინის პრინციპებით:
- რესპონსიული ბადის განლაგებები
- შეხებისთვის მორგებული ღილაკები და ინტერაქციები
- ოპტიმიზებული ყველა ეკრანის ზომისთვის
- მორბენი ანიმაციები და გადასვლები

## 🚀 განთავსება

### Vercel განთავსება
1. დაუკავშირდით თქვენი GitHub რეპოზიტორია Vercel-ს
2. დააყენეთ გარემოს ცვლადები Vercel დაფაში
3. განათავსეთ ავტომატურად ძირითად ბრენჩში გადმოწერისას

### ქრონ დავალების დაყენება
`vercel.json` ფაილი კონფიგურირებს ავტომატურ ყოველდღიურ საკვების გენერაციას:
- გაუშვებს ყოველ დღეს 12:00-ზე
- უწოდებს `/api/cron/daily-meal-generator`
- საჭიროებს სწორ ავტორიზაციას

## 🔧 მორგება

### ახალი საკვების ტიპების დამატება
1. განაახლეთ `MealPlan` ინტერფეისი `lib/types.ts`-ში
2. დაამატეთ საკვების ტიპის კონფიგურაცია `MealCard.tsx`-ში
3. განაახლეთ დიეტის გვერდი ახალი საკვების ჩვენებისთვის

### AI პრომპტების შეცვლა
ჩაასწორეთ პრომპტი `lib/openai.ts`-ში:
- შეცვალეთ ნუტრიციის განახლებები
- დაამატეთ ახალი დიეტური შეზღუდვები
- შეცვალეთ საკვების სტრუქტურა
- განაახლეთ კალორიების გამოთვლები

### სტილის მორგება
- შეცვალეთ Tailwind კლასები ფერების სქემისთვის
- განაახლეთ Framer Motion ანიმაციები
- მორგეთ კომპონენტების განლაგებები

## 🐛 პრობლემების გადაჭრა

### საერთო პრობლემები

1. **საკვების გეგმა ვერ მოიძებნა**
   - შეამოწმეთ არსებობს თუ არა ბავშვის პროფილი
   - შეამოწმეთ ქრონ დავალება გაშვებულია
   - შეამოწმეთ OpenAI API გასაღები

2. **მონაცემთა ბაზის დაკავშირების შეცდომები**
   - შეამოწმეთ Supabase მომხმარებლის რეკვიზიტები
   - შეამოწმეთ მონაცემთა ბაზის სქემა
   - დარწმუნდით სწორ ნებართვებში

3. **AI გენერაციის შეცდომები**
   - შეამოწმეთ OpenAI API კვოტა
   - შეამოწმეთ პრომპტის სტრუქტურა
   - გადახედეთ შეცდომების ჟურნალს

## 📈 მომავალი გაუმჯობესებები

### დაგეგმილი ფუნქციები
- კვირეული საკვების დაგეგმვა
- საყვარელი საკვების შენახვა
- რეცეპტების გაზიარება
- ნუტრიციის ანალიტიკა
- საკვების ფოტოს ატვირთვა
- ოჯახის საკვების დაგეგმვა

### მასშტაბირებადობის გაუმჯობესებები
- ქეშირება უკეთესი წარმადობისთვის
- მონაცემთა ბაზის ოპტიმიზაცია
- CDN სტატიკური აქტივებისთვის
- მიკროსერვისების არქიტექტურა

## 🤝 წვლილის შეტანა

1. გადაიტანეთ რეპოზიტორია
2. შექმენით ფუნქციის ბრენჩი
3. შეიტანეთ თქვენი ცვლილებები
4. დაამატეთ ტესტები შესაბამისად
5. წარმოადგინეთ pull request

## 📄 ლიცენზია

ეს პროექტი ნაწილია Parentlytics პლატფორმის და არის საკუთრების პროგრამული უზრუნველყოფა.

---

**აგებულია ❤️ მშობლებისთვის და მათი ბავშვების ჯანმრთელობისთვის**